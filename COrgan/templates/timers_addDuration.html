{% extends "luminouslayout.html" %}

{% block LHeader %}
    <!-- DATE RANGE PICKER -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('LDashboard.static', filename='js/bootstrap-daterangepicker/daterangepicker-bs3.css') }}" />
    <!-- TYPEAHEAD -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('LDashboard.static', filename='js/typeahead/typeahead.css') }}" />
    <!-- SELECT2 -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('LDashboard.static', filename='js/select2/select2.min.css') }}" />
    <!-- UNIFORM -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('LDashboard.static', filename='js/uniform/css/uniform.default.min.css') }}" />
    <!-- JQUERY UPLOAD -->
    <!-- blueimp Gallery styles -->
    <link rel="stylesheet" href="{{ url_for('LDashboard.static', filename='js/blueimp/gallery/blueimp-gallery.min.css') }}">
    <!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
    <link rel="stylesheet" href="{{ url_for('LDashboard.static', filename='js/jquery-upload/css/jquery.fileupload.css') }}">
    <link rel="stylesheet" href="{{ url_for('LDashboard.static', filename='js/jquery-upload/css/jquery.fileupload-ui.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('LDashboard.static', filename='js/datepicker/themes/default.min.css') }}" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('LDashboard.static', filename='js/datepicker/themes/default.date.min.css') }}" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('LDashboard.static', filename='js/datepicker/themes/default.time.min.css') }}" />
{% endblock %}

{% block LBody %}
    <div class="container">
        <div class="row">
            <div id="content" class="col-lg-12">
                <!-- PAGE HEADER-->
                <div class="row">
                    <div class="col-sm-12">
                        <div class="page-header">
                            <!-- BREADCRUMBS -->
                            <ul class="breadcrumb">
                                <li>
                                    <i class="fa fa-home"></i>
                                    <a href="{{ url_for('LDashboard.home') }}">Home</a>
                                </li>
                                <li>
                                    {{ L_PageTitle }}
                                </li>
                            </ul>
                            <!-- /BREADCRUMBS -->
                            <div class="clearfix">
                                <h3 class="content-title pull-left">{{ L_PageTitle }}</h3>
                            </div>
                            <div class="description">{{ L_PageDescription }}</div>
                        </div>
                    </div>
                </div>
                <!-- /PAGE HEADER -->
                <!-- FORMS -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-12">
                                <!-- BASIC -->
                                <div class="box border orange">
                                    <div class="box-title">
                                        <h4><i class="fa fa-clock-o"></i>新建定时器</h4>
                                    </div>
                                    <div class="box-body big">
                                        <form method="post" action="{{ url_for('LDashboard.performAddDurationTimer') }}">
                                            <div class="form-group">
                                                <label for="tName">任务计划唯一名字：</label>
                                                <input name="f_name" class="form-control" id="tName">
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label" for="e2">计划的工作项：</label>
                                                <select onchange="checkselect('e2')" name="f_accessList" multiple id="e2" class="col-md-12">
                                                    {% for wid in widList %}
                                                        <option>{{ wid["name"] }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <br/><br/><br/>
                                            <div class="form-group">
                                                <label for="tCron">任务周期的类Cron表达式：</label>
                                                <input name="f_cron" type="text" class="form-control" id="tCron">
                                                <br/>
                                                <span>表达式以 <span style="color: royalblue;"><b>Key1:Value1;Key2:Value2...</b></span> 的形式书写，其中Key是时间间隔单位，Value是时间表达式，遵循CRON规范</span><br/>
                                                <span>Key是时间间隔的单位，有：</span><br/>
                                                <table cellpadding="2" cellspacing="0" border="1" style="border:1px solid silver">
                                                    <tbody>
                                                    <tr>
                                                        <td>
                                                            year
                                                        </td>
                                                        <td>
                                                            4-digit year<br />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            month
                                                        </td>
                                                        <td>
                                                            month (1-12)
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            day
                                                        </td>
                                                        <td>
                                                            day of the (1-31)
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            week
                                                        </td>
                                                        <td>
                                                            ISO week (1-53)
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            day_of_week
                                                        </td>
                                                        <td>
                                                            number or name of weekday (0-6 or&nbsp;mon,tue,wed,thu,fri,sat,sun)
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            hour
                                                        </td>
                                                        <td>
                                                            hour (0-23)<br />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            minute
                                                        </td>
                                                        <td>
                                                            minute (0-59)<br />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            second
                                                        </td>
                                                        <td>
                                                            second (0-59)<br />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            start_date
                                                        </td>
                                                        <td>
                                                            earliest possible date/time to trigger on (inclusive)<br />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            end_date
                                                        </td>
                                                        <td>
                                                            latest possible date/time to trigger on (inclusive)<br />
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                                <br/>
                                                <span>Value是时间间隔的表达式，例如每两小时执行一次的表达式为：<b>hour:*/2</b>，关于表达式语法详见下表。</span>
                                                <br/><br/>
                                                <table border="1" cellpadding="0">
                                                    <tbody style="margin:0px; padding:0px">
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:0px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px"><strong style="margin:0px; padding:0px">Expression</strong></p>
                                                        </td>
                                                        <td style="margin:0px; padding:0px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px"><strong style="margin:0px; padding:0px">Field</strong></p>
                                                        </td>
                                                        <td style="margin:0px; padding:0px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px"><strong style="margin:0px; padding:0px">Description</strong></p>
                                                        </td>
                                                    </tr>
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:0px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">*</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">any</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">Fire on every value</p>
                                                        </td>
                                                    </tr>
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">*/a</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">any</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">Fire every a values, starting from the minimum</p>
                                                        </td>
                                                    </tr>
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">a-b</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">any</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">Fire on any value within the a-b range (a must be smaller than b)</p>
                                                        </td>
                                                    </tr>
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">a-b/c</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">any</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">Fire every c values within the a-b range</p>
                                                        </td>
                                                    </tr>
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">xth y</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">day</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">Fire on the x -th occurrence of weekday y within the month</p>
                                                        </td>
                                                    </tr>
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">last x</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">day</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">Fire on the last occurrence of weekday x within the month</p>
                                                        </td>
                                                    </tr>
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">last</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">day</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">Fire on the last day within the month</p>
                                                        </td>
                                                    </tr>
                                                    <tr style="margin:0px; padding:0px">
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">x,y,z</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">any</p>
                                                        </td>
                                                        <td style="margin:0px; padding:3px; border:1px solid silver; border-collapse:collapse">
                                                            <p style="margin:0px auto; padding:0px; text-indent:0px">Fire on any matching expression; can combine any number of any of the above expressions</p>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <br/><br/>
                                            <input type="hidden" name="output_binds" id="output_binds">
                                            <button type="submit" class="btn btn-success col-md-3">提交</button>
                                            <br/>
                                        </form>
                                    </div>
                                </div>
                                <!-- /BASIC -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /FORMS -->
                <div class="separator"></div>
                <div class="footer-tools">
			<span class="go-top">
				<i class="fa fa-chevron-up"></i> Top
			</span>
                </div>
            </div><!-- /CONTENT-->
        </div>
    </div>
{% endblock %}

{% block LScript %}
    <!-- TYPEHEAD -->
    <script type="text/javascript" src="{{ url_for('LDashboard.static', filename='js/typeahead/typeahead.min.js') }}"></script>
    <!-- AUTOSIZE -->
    <script type="text/javascript" src="{{ url_for('LDashboard.static', filename='js/autosize/jquery.autosize.min.js') }}"></script>
    <!-- COUNTABLE -->
    <script type="text/javascript" src="{{ url_for('LDashboard.static', filename='js/countable/jquery.simplyCountable.min.js') }}"></script>
    <!-- INPUT MASK -->
    <script type="text/javascript" src="{{ url_for('LDashboard.static', filename='js/bootstrap-inputmask/bootstrap-inputmask.min.js') }}"></script>
    <!-- SELECT2 -->
    <script type="text/javascript" src="{{ url_for('LDashboard.static', filename='js/select2/select2.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('LDashboard.static', filename='js/datepicker/picker.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('LDashboard.static', filename='js/datepicker/picker.date.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('LDashboard.static', filename='js/datepicker/picker.time.js') }}"></script>

    <script>
        jQuery(document).ready(function() {
            jQuery("#active-timers").addClass("active");
            jQuery("#selected-timers").addClass("selected");
            $(".datepicker").datepicker();
            $(".inlinepicker").datepicker({
                inline: true,
                showOtherMonths: true
            });
            $(".datepicker-fullscreen").pickadate();
            $(".timepicker-fullscreen").pickatime();
            App.setPage("forms");  //Set current page
            App.init(); //Initialise plugins and elements
        });
        function checkselect(objname) {
            o = document.getElementById(objname);
            t = document.getElementById("output_binds");
            var intvalue="";
            for(i=0;i<o.length;i++){
                if(o.options[i].selected){
                    intvalue+=o.options[i].value+";";
                }
            }
            t.value=intvalue.substr(0,intvalue.length-1);
            console.log(t.value);
        }

    </script>
{% endblock %}